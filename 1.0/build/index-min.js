/*!build time : 2014-04-22 3:04:45 PM*/
KISSY.add("gallery/number-range/1.0/index",function(a,b,c,d){function e(){this._init.apply(this,arguments)}var f=b.all,g={tipType:"force",fixed:null,cls:"",tpl:"{tipText}",offset:[0,0],points:["cr","cl"],min:0,max:1e10,minTipText:"\u53ef\u8f93\u5165\u7684\u6700\u5c0f\u6570\u91cf\u4e3a{value}",maxTipText:"\u53ef\u8f93\u5165\u7684\u6700\u5927\u6570\u91cf\u4e3a{value}",success:null,error:null};return a.augment(e,a.EventTarget,{_init:function(b){this.cfg=a.merge(g,b)},_isNumber:function(a){return/^\d+(\.\d*)?$/g.test(a)},_removeNotNumber:function(a,b){if(b){var c=b.replace(/[^\d.]/g,""),d=c.split(".");d.length>2&&(c=d.shift()+"."+d.join("")),a.val(c)}},_fixedNumber:function(a,b){var c=void 0!=a[0].fixed?a[0].fixed:this.cfg.fixed,d=b.indexOf(".");if("number"==typeof c&&-1!=d&&(0==c||b.split(".")[1].length>c)){var e=0==c?d:d+c+1;b=b.substring(0,e),a.val(b)}return b},_forceFillin:function(a,b){b&&b.value&&a.val(b.value)},_showTip:function(b,c){var e=this,f=c.type+"TipText",g=a.substitute(b[f]||this.cfg[f],c),h=a.substitute(b.tpl||this.cfg.tpl,{tipText:g});b[0].Popup||(b[0].Popup=new d.Popup({elCls:b.cls||e.cfg.cls}),b[0].Popup.render()),b[0].Popup.set("content",h),b[0].Popup.set("align",{points:b[0].points||e.cfg.points,offset:b[0].offset||e.cfg.offset,node:b}),b[0].Popup.show()},_hidePopup:function(a){a[0].Popup&&a[0].Popup.hide()},_checkNumber:function(a,b){var c,d=1*a.attr("data-min")||1*a[0].min||this.cfg.min,e=1*a.attr("data-max")||1*a[0].max||this.cfg.max,b=this._fixedNumber(a,b);if(d>b?c={type:"min",value:d}:b>e&&(c={type:"max",value:e}),c){var f=a[0].error||this.cfg.error;if(f)f(a,c);else{var g=a[0].tipType||this.cfg.tipType,h="force"==g?"_forceFillin":"_showTip";this[h](a,c)}}else{var i=a[0].success||this.cfg.success;i?i(a):this._hidePopup(a)}},_checkEL:function(b){var c=a.trim(b.val());this._isNumber(c)?this._checkNumber(b,c):(this._removeNotNumber(b,c),this._hidePopup(b))},_setEL:function(b,c,d){if(b){var e=a.merge(g,c||{}),h="string"==typeof b?f(b):b;return h.each(function(b){a.each(e,function(a,c){b[0][c]=a}),d&&d(b)}),h}},verify:function(a,b){var c=this;this._setEL(a,b,function(a){c._checkEL(a)})},bind:function(a,b){var c=this;this._setEL(a,b,function(a){a.on("valuechange",function(){c._checkEL(a)})})}}),e},{requires:["node","event","overlay"]});